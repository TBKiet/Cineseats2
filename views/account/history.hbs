<section class="d-flex">
    {{> sidebar2 }}
    <div class="d-flex flex-md-row p-0">
        <!-- Booking History Section -->
        <section class="col-md-8 container mx-0 my-5 pb-4 bg-white rounded shadow">
            <h1 class="mb-4 fw-bold">Booking History</h1>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th>Booking ID</th>
                    <th>Movie Title</th>
                    <th>Showtime</th>
                    <th>Total Amount</th>
                    <th>Payment Status</th>
                    <th>Booking Date</th>
                </tr>
                </thead>
                <tbody id="booking-history-body">
                <!-- Booking history will be populated here -->
                </tbody>
            </table>
        </section>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            const response = await fetch('/account/booking');
            if (response.ok) {
                const bookings = await response.json();
                const bookingHistoryBody = document.getElementById('booking-history-body');

                bookings.forEach(booking => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${booking.bookingID}</td>
                        <td>${booking.movieTitle}</td>
                        <td>${booking.showtime}</td>
                        <td>${booking.totalAmount} Ä‘</td>
                        <td>${booking.paymentStatus}</td>
                        <td>${new Date(booking.bookingDateTime).toLocaleDateString()}</td>
                    `;
                    bookingHistoryBody.appendChild(row);
                });
            } else {
                console.error('Failed to fetch booking history');
            }
        } catch (error) {
            console.error('Error fetching booking history:', error);
        }
    });
</script>